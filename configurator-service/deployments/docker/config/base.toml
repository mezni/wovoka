# Base Configuration - Common settings across all environments
# Environment-specific overrides can be provided via environment variables

[server]
# Server configuration
host = "0.0.0.0"
port = 8080
workers = 4
max_connections = 10000
request_timeout_seconds = 30
shutdown_timeout_seconds = 30

# CORS settings
[server.cors]
allowed_origins = ["http://localhost:3000", "https://yourdomain.com"]
allowed_methods = ["GET", "POST", "PUT", "DELETE", "PATCH"]
allowed_headers = ["Authorization", "Content-Type", "Accept"]
allow_credentials = false
max_age = 3600

[database]
# Database connection settings
# These will be overridden by environment variables in production
host = "localhost"
port = 5432
name = "your_service_db"
username = "app_user"
# Password should be set via environment variable
pool_size = 20
connection_timeout_seconds = 30
acquire_timeout_seconds = 30
idle_timeout_seconds = 600
max_lifetime_seconds = 1800

# Database connection pool settings
[database.pool]
max_connections = 20
min_connections = 5
connect_timeout = 30
idle_timeout = 600

[redis]
# Redis configuration for caching/sessions
enabled = false
host = "localhost"
port = 6379
# password = ""  # Set via environment variable
database = 0
pool_size = 10
connection_timeout_seconds = 5
read_timeout_seconds = 3
write_timeout_seconds = 3

[logging]
# Logging configuration
level = "info"  # debug, info, warn, error
format = "json"  # json, text
enable_ansi_colors = false

# Structured logging fields
[logging.fields]
service_name = "your-ddd-service"
version = "1.0.0"

[observability]
# Metrics and observability
metrics_enabled = true
tracing_enabled = true
health_check_enabled = true

[observability.prometheus]
enabled = true
path = "/metrics"
port = 8081

[observability.jaeger]
enabled = false
endpoint = "http://jaeger:14268/api/traces"

[auth]
# Authentication & Authorization
jwt_secret = "change-in-production"  # Override via APP_AUTH_JWT_SECRET
jwt_expiry_hours = 24
bcrypt_cost = 12

[auth.rate_limiting]
enabled = true
requests_per_minute = 60
burst_size = 10

[cache]
# Application-level caching
default_ttl_seconds = 300  # 5 minutes
max_capacity = 10000

[external_services]
# External service configurations

[external_services.email]
enabled = false
base_url = "https://api.email-service.com"
timeout_seconds = 10
retry_attempts = 3

[external_services.payment]
enabled = false
base_url = "https://api.payment-service.com"
timeout_seconds = 30
retry_attempts = 3

[domain]
# Domain-specific settings
default_page_size = 20
max_page_size = 100

[domain.users]
min_password_length = 8
max_login_attempts = 5
account_lockout_minutes = 30

[domain.orders]
default_currency = "USD"
max_items_per_order = 50

[features]
# Feature flags
enable_new_shipping_calculator = false
enable_payment_webhooks = true
maintenance_mode = false

[background_tasks]
# Background job processing
enabled = true
worker_count = 2
poll_interval_seconds = 5
max_retries = 3

# Health check configuration
[health]
live_check_path = "/health/live"
ready_check_path = "/health/ready"
enable_detailed_checks = true

[health.checks]
database = true
redis = false
external_services = false